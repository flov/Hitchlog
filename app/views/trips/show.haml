#trips_show
  .left
    %h1.text_center
      = hitchhiking_with_image(@trip)
      %span#start= @trip.from
      &rarr;
      %span#end= @trip.to
      = link_to '(Edit Trip)', edit_trip_path(@trip) if @trip.user == current_user
    - @trip.hitchhikes.not_empty.each do |ride|
      %h1
        #{number_to_ordinal(ride.number)} Ride - 
        = ride.title
        - @trip.countries_with_distance.each do |hash|
          = country_images(hash)
      %p
        = images_for_hitchhike(ride)
        - if @trip.user == current_user
          = link_to add_information_image, edit_hitchhike_path(ride)
      %p
        = ride.story
      
  .right
    %h1.text_center= @trip.user
    .text_center=gravatar_image_tag @user.email
    %p
      Total Amount: #{@hitchhiked_kms} km<br/>
      Hitchhiked Countries: #{@hitchhiked_countries.size}<br/>
      Cars seen from inside: #{@rides.size}<br/>
      = "average waiting time: #{@average_waiting_time} minutes<br/>".html_safe if @average_waiting_time
      = render 'shared/country_chart', :user => @trip.user, :resolution => '200x100', :size => 'tiny'

- title trip_show_title(@trip)
- content_for :topmenu do
  - if @photos.empty?
    #map_canvas{:style=>"width:950px"}
  - else
    #map_canvas{:style=>"width:450px"}
    #hitchhike-photo= image_tag ride.photo.url(:cropped), :id => 'hitchhike-photo-photo'

-content_for :head do
  :javascript
    $(function(){
      var directionDisplay;
      var directionsService = new google.maps.DirectionsService();
      var map;
      initialize();
      calcRoute();

      function initialize() {
        directionsDisplay = new google.maps.DirectionsRenderer();
        var chicago = new google.maps.LatLng(41.850033, -87.6500523);
        var myOptions = {
          zoom:6,
          mapTypeId: google.maps.MapTypeId.HYBRID,
          center: chicago
        }
        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        directionsDisplay.setMap(map);
      }
        
      function calcRoute() {
        var start = $("#start").html()
        var end = $("#end").html()
        var request = {
          origin:start, 
          destination:end,
          travelMode: google.maps.DirectionsTravelMode.DRIVING
        };
        directionsService.route(request, function(result, status) {
          if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(result);
          }
        });
      }
    });

  :css
    body #content .container {padding-top: 0; padding-bottom: 40px;}

